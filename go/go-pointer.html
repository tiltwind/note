<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="//vogo.github.io/markhtml/css/markhtml.css">
    <title>Index</title>
</head>
<body class="markdown-body">
    <div id="navbar"></div>
    <div id="menu"></div>
    <div class="main" id="app">
<!---
markmeta_author: wongoo
markmeta_date: 2019-03-12
markmeta_title: Go 三种指针
markmeta_categories: 编程语言
markmeta_tags: golang,pointer
-->

<h1>Golang 三种指针</h1>
<ul>
<li><code>*T</code>：普通指针，用于传递对象地址，不能进行指针运算。</li>
<li><code>unsafe.Pointer</code>：通用指针类型，用于转换不同类型的指针，不能进行指针运算。</li>
<li><code>uintptr</code>：用于指针运算，GC 不把 uintptr 当指针，uintptr 无法持有对象。uintptr 类型的目标会被回收。</li>
</ul>
<h2>unsafe.Pointer 特别之处</h2>
<ul>
<li>unsafe.Pointer 可以和 普通指针 进行相互转换。</li>
<li>unsafe.Pointer 可以和 uintptr 进行相互转换。</li>
</ul>
<p>也就是说 unsafe.Pointer 是桥梁，可以让任意类型的指针实现相互转换，也可以将任意类型的指针转换为 uintptr 进行指针运算。</p>
<ul>
<li>unsafe.Pointer其实就是类似C的<code>void *</code>，在golang中是用于各种指针相互转换的桥梁。</li>
<li>uintptr是golang的内置类型，是能存储指针的整型，uintptr的底层类型是int，它和unsafe.Pointer可相互转换。</li>
</ul>
<h2>uintptr和unsafe.Pointer的区别就是：</h2>
<ul>
<li>unsafe.Pointer 只是单纯的通用指针类型，用于转换不同类型指针，它不可以参与指针运算；</li>
<li>而 uintptr 是用于指针运算的，GC 不把 uintptr 当指针，也就是说 uintptr 无法持有对象，uintptr类型的目标会被回收。</li>
</ul>
<h2>参考</h2>
<ul>
<li><a href="https://skyao.io/learning-go/stdlib/unsafe/">https://skyao.io/learning-go/stdlib/unsafe/</a></li>
</ul>

</div>
<script src="//vogo.github.io/markhtml/js/markhtml.js"></script>
</body>
</html>
